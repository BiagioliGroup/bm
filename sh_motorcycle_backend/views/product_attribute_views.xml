<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- VISTA MEJORADA PARA ATRIBUTOS -->
  <record id="product_attribute_form_inherit_unit" model="ir.ui.view">
    <field name="name">product.attribute.form.inherit.unit</field>
    <field name="model">product.attribute</field>
    <field name="inherit_id" ref="product.product_attribute_view_form"/>
    <field name="arch" type="xml">
      <!-- Inserta la unidad justo después del campo name -->
      <xpath expr="//field[@name='name']" position="after">
        <field name="unit_id" placeholder="Ej: Milímetros, Kilogramos, Litros..."/>
      </xpath>
      
      <!-- Mejora la presentación de las categorías técnicas -->
      <xpath expr="//sheet" position="inside">
        <separator string="Categorías Técnicas"/>
        <group colspan="2">
          <field name="categ_ids" widget="many2many_tags" 
                 options="{'color_field': 'name', 'no_create': True}"
                 placeholder="Selecciona las categorías donde se aplica este atributo..."/>
        </group>
        
        <separator string="Información Adicional"/>
        <group>
          <group>
            <label for="unit_id" string="Nota sobre Unidades"/>
            <div class="text-muted">
              La unidad de medida se mostrará automáticamente junto al nombre del atributo
              y sus valores en todas las vistas del sistema.
            </div>
          </group>
          <group>
            <label for="categ_ids" string="Nota sobre Categorías"/>
            <div class="text-muted">
              Las categorías técnicas permiten filtrar qué atributos están disponibles
              para cada tipo de producto o motocicleta.
            </div>
          </group>
        </group>
      </xpath>
    </field>
  </record>

  <!-- VISTA MEJORADA PARA LISTA DE ATRIBUTOS -->
  <record id="product_attribute_tree_enhanced" model="ir.ui.view">
    <field name="name">product.attribute.tree.enhanced</field>
    <field name="model">product.attribute</field>
    <field name="inherit_id" ref="product.product_attribute_view_tree"/>
    <field name="arch" type="xml">
      <xpath expr="//list" position="attributes">
        <attribute name="decoration-info">unit_id</attribute>
        <attribute name="decoration-success">categ_ids</attribute>
        <attribute name="sample">1</attribute>
      </xpath>
      
      <xpath expr="//field[@name='name']" position="after">
        <field name="unit_id" optional="show"/>
        <field name="categ_ids" widget="many2many_tags" 
               options="{'color_field': 'name'}" optional="show"/>
      </xpath>
    </field>
  </record>

  <!-- MEJORAS EN LÍNEAS DE ATRIBUTOS DE PLANTILLA -->
  <record id="sh_moto_inherit_ptal_tree_uom" model="ir.ui.view">
    <field name="name">sh.motorcycle.backend.ptal.tree.uom</field>
    <field name="model">product.template.attribute.line</field>
    <field name="inherit_id" ref="product.product_template_attribute_line_view_tree"/>
    <field name="arch" type="xml">
      <xpath expr="//list" position="attributes">
        <attribute name="decoration-info">attribute_id.unit_id</attribute>
        <attribute name="sample">1</attribute>
      </xpath>
      
      <xpath expr="//field[@name='attribute_id']" position="attributes">
        <attribute name="options">{'no_create': True}</attribute>
      </xpath>
      
      <xpath expr="//field[@name='value_ids']" position="attributes">
        <attribute name="context">{'default_attribute_id': attribute_id, 'show_attribute': True}</attribute>
        <attribute name="widget">many2many_tags</attribute>
        <attribute name="options">{'color_field': 'name'}</attribute>
      </xpath>
    </field>
  </record>

  <record id="sh_moto_inherit_ptal_form_uom" model="ir.ui.view">
    <field name="name">sh.motorcycle.backend.ptal.form.uom</field>
    <field name="model">product.template.attribute.line</field>
    <field name="inherit_id" ref="product.product_template_attribute_line_form"/>
    <field name="arch" type="xml">
      <xpath expr="//form" position="attributes">
        <attribute name="string">Línea de Atributo del Producto</attribute>
      </xpath>
      
      <xpath expr="//field[@name='attribute_id']" position="after">
        <div class="alert alert-info" role="alert" 
             invisible="attribute_id == False">
          <strong>Atributo seleccionado:</strong> 
          <field name="attribute_id" readonly="1" style="font-weight: normal;" invisible="1"/>
          <span invisible="attribute_id.unit_id == False">
            - Unidad: <field name="attribute_id" invisible="1"/><span>[unit_id.name]</span>
          </span>
        </div>
      </xpath>
      
      <xpath expr="//field[@name='value_ids']" position="attributes">
        <attribute name="context">{'default_attribute_id': attribute_id, 'show_attribute': True}</attribute>
        <attribute name="widget">many2many_tags</attribute>
        <attribute name="options">{'color_field': 'name', 'no_create': False}</attribute>
      </xpath>
      
      <xpath expr="//field[@name='value_ids']" position="after">
        <div class="text-muted mt-2">
          <small>
            <i class="fa fa-info-circle"/> 
            Los valores seleccionados mostrarán automáticamente la unidad de medida 
            si está configurada para este atributo.
          </small>
        </div>
      </xpath>
    </field>
  </record>

  <!-- VISTA MEJORADA PARA VALORES DE ATRIBUTOS -->
  <record id="product_attribute_value_tree_enhanced" model="ir.ui.view">
    <field name="name">product.attribute.value.tree.enhanced</field>
    <field name="model">product.attribute.value</field>
    <field name="inherit_id" ref="product.variants_tree_view"/>
    <field name="arch" type="xml">
      <xpath expr="//list" position="attributes">
        <attribute name="decoration-info">attribute_id.unit_id</attribute>
        <attribute name="sample">1</attribute>
      </xpath>
      
      <xpath expr="//field[@name='attribute_id']" position="attributes">
        <attribute name="widget">badge</attribute>
        <attribute name="options">{'color_field': 'name'}</attribute>
      </xpath>
      
      <xpath expr="//field[@name='name']" position="after">
        <field name="attribute_id" column_invisible="1"/>
        <field name="attribute_id.unit_id" string="Unidad" optional="show" readonly="1"/>
      </xpath>
    </field>
  </record>
</odoo>