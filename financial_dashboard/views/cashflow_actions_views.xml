<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================== -->
    <!-- ACCIONES ADICIONALES PARA CATEGORÍAS -->
    <!-- ========================================== -->
    
    <!-- Acción para Categorías de Cashflow -->
    <record id="action_cashflow_category" model="ir.actions.act_window">
        <field name="name">Categorías de Cashflow</field>
        <field name="res_model">cashflow.category</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Define categorías para organizar tu cashflow
            </p>
            <p>
                Las categorías te ayudan a clasificar y analizar mejor tus proyecciones:
                • Operativo (ventas, compras, gastos corrientes)<br/>
                • Inversión (compra de activos, inversiones)<br/>
                • Financiamiento (préstamos, aportes de capital)<br/>
            </p>
        </field>
    </record>

    <!-- Vistas para Categorías de Cashflow -->
    <record id="view_cashflow_category_list" model="ir.ui.view">
        <field name="name">cashflow.category.list</field>
        <field name="model">cashflow.category</field>
        <field name="arch" type="xml">
            <list string="Categorías de Cashflow">
                <field name="sequence" widget="handle"/>
                <field name="name"/>
                <field name="code"/>
                <field name="category_type"/>
                <field name="flow_type"/>
                <field name="projection_count"/>
                <field name="total_projected" widget="monetary"/>
                <field name="active"/>
            </list>
        </field>
    </record>

    <record id="view_cashflow_category_form" model="ir.ui.view">
        <field name="name">cashflow.category.form</field>
        <field name="model">cashflow.category</field>
        <field name="arch" type="xml">
            <form string="Categoría de Cashflow">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_view_projections"
                                icon="fa-line-chart" invisible="projection_count == 0">
                            <field string="Proyecciones" name="projection_count" widget="statinfo"/>
                        </button>
                    </div>
                    
                    <group>
                        <group>
                            <field name="name"/>
                            <field name="code"/>
                            <field name="sequence"/>
                        </group>
                        <group>
                            <field name="color" widget="color"/>
                            <field name="active"/>
                            <field name="total_projected" readonly="1"/>
                            <field name="currency_id" column_invisible="1"/>
                        </group>
                    </group>
                    
                    <group>
                        <group name="classification" string="Clasificación">
                            <field name="category_type"/>
                            <field name="flow_type"/>
                        </group>
                        <group name="accounting" string="Configuración Contable">
                            <field name="default_account_ids" widget="many2many_tags"/>
                        </group>
                    </group>
                    
                    <field name="description"/>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- ACCIONES DE REPORTES DE CASHFLOW -->
    <!-- ========================================== -->
    <!-- TODO: Crear modelo cashflow.report.wizard cuando sea necesario -->
    <!--
    <record id="action_cashflow_report_wizard" model="ir.actions.act_window">
        <field name="name">Generar Reporte de Cashflow</field>
        <field name="res_model">cashflow.report.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
    -->

    <!-- ========================================== -->
    <!-- CONFIGURACIÓN DE INFORMES -->
    <!-- ========================================== -->
    
    <!-- Acción de reporte para imprimir dashboard -->
    <record id="action_print_dashboard_summary" model="ir.actions.report">
        <field name="name">Resumen Dashboard Financiero</field>
        <field name="model">financial.dashboard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">financial_dashboard.report_dashboard_summary</field>
        <field name="report_file">financial_dashboard.report_dashboard_summary</field>
        <field name="binding_model_id" ref="model_financial_dashboard"/>
        <field name="binding_type">report</field>
    </record>

    <!-- Acción para mostrar ayuda -->
    <record id="action_help_fiscal_system" model="ir.actions.act_window">
        <field name="name">Sistema de Clasificación Fiscal</field>
        <field name="res_model">financial.dashboard</field>
        <field name="view_mode">kanban</field>
        <field name="domain">[('id', '=', 0)]</field>
        <field name="help" type="html">
            <div class="o_view_nocontent_neutral_face">
                <h2>Sistema de Clasificación Fiscal</h2>
                <p>Su Dashboard Financiero utiliza clasificación automática basada en códigos de journals:</p>
                
                <h3><span class="badge text-bg-success">FISCAL (Blanco)</span></h3>
                <ul>
                    <li><strong>Bancos:</strong> CLV (CLOVER), BCIUD (Banco Ciudad), MP (Mercado Pago), BNK1 (VIUMI)</li>
                    <li><strong>Ventas:</strong> 00010, 00011 (Facturas de Ventas y Exportación)</li>
                    <li><strong>Tarjetas:</strong> CCD1, CCD2 (Tarjetas Corporativas)</li>
                    <li><strong>Compras/Gastos:</strong> COMPR (Proveedores Fiscal), SLR-F (Salarios Fiscal), Imp (Impuestos)</li>
                </ul>
                
                <h3><span class="badge text-bg-dark">NO FISCAL (Negro)</span></h3>
                <ul>
                    <li><strong>Efectivo:</strong> EFE1 (Caja Diaria), EFE2 (Caja Fuerte), CSH4 (Dólares Caja Fuerte)</li>
                    <li><strong>Bancos:</strong> STRIP (Stripe), BofA (Bank of America)</li>
                    <li><strong>Ventas/Compras:</strong> X (Comprobantes Ventas), CCOMP (Comprobantes Compra)</li>
                    <li><strong>Salarios:</strong> SLR-N (Salarios No Fiscal)</li>
                </ul>
                
                <h3>Funcionalidades Automáticas</h3>
                <ul>
                    <li>✅ Separación automática de saldos por clasificación fiscal</li>
                    <li>✅ Importación de facturas con clasificación automática</li>
                    <li>✅ Proyecciones de cashflow integradas</li>
                    <li>✅ Análisis comparativo fiscal vs no fiscal</li>
                    <li>✅ Alertas y notificaciones contextuales</li>
                </ul>
            </div>
        </field>
    </record>

    <!-- ========================================== -->
    <!-- ACCESOS RÁPIDOS EN DASHBOARD DE CONTABILIDAD -->
    <!-- ========================================== -->
    
    <!-- Agregar tarjeta en dashboard de contabilidad -->
    <record id="account_journal_dashboard_inherit_financial" model="ir.ui.view">
        <field name="name">account.journal.dashboard.inherit.financial</field>
        <field name="model">account.journal</field>
        <field name="inherit_id" ref="account.account_journal_dashboard_kanban_view"/>
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="before">
                <!-- Agregar botón de acceso rápido al dashboard financiero -->
                <div class="alert alert-info mb-3" role="alert">
                    <div class="row align-items-center">
                        <div class="col-9">
                            <strong><i class="fa fa-dashboard me-2"/>Dashboard Financiero Disponible</strong><br/>
                            <small>Control completo con clasificación Fiscal/No Fiscal, cashflow y gastos periódicos</small>
                        </div>
                        <div class="col-3 text-end">
                            <a href="/web#action=financial_dashboard.action_financial_dashboard" 
                               class="btn btn-primary btn-sm">
                                <i class="fa fa-external-link me-1"/>Abrir Dashboard
                            </a>
                        </div>
                    </div>
                </div>
            </xpath>
        </field>
    </record>

</odoo>